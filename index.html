<div class="card">
    <div class="card-header">ğŸŸï¸ åˆ®åˆ®æ¨‚é€²éŠ·å­˜ (2000å…ƒå€ç¯„ä¾‹)</div>
    <div class="card-body">
        <div class="row g-2 mb-3 bg-light p-2 rounded">
            <div class="col-6">
                <label class="unit-label">å‰æ—¥æ•´æœ¬ + æ–°é€²</label>
                <div class="input-group">
                    <input type="number" id="sc_prev_book" class="form-control sc-logic" placeholder="å‰æ—¥" value="5">
                    <span class="input-group-text">+</span>
                    <input type="number" id="sc_new_book" class="form-control sc-logic" placeholder="æ–°é€²" value="7">
                </div>
            </div>
            <div class="col-6">
                <label class="unit-label">å‰æ—¥å‰©é¤˜é›¶å¼µ</label>
                <input type="number" id="sc_prev_loose" class="form-control sc-logic" value="21">
            </div>
        </div>

        <div class="row g-2 mb-3 p-2 border rounded">
            <div class="col-6">
                <label class="unit-label text-danger">ä»Šæ—¥å‰©é¤˜æ•´æœ¬</label>
                <input type="number" id="sc_today_book" class="form-control sc-logic" value="6">
            </div>
            <div class="col-6">
                <label class="unit-label text-danger">ä»Šæ—¥å‰©é¤˜é›¶å¼µ</label>
                <input type="number" id="sc_today_loose" class="form-control sc-logic" value="10">
            </div>
        </div>

        <div class="row g-2 align-items-center">
            <div class="col-12">
                <div class="alert alert-info mb-0 py-2">
                    <strong>å”®å‡ºå¼µæ•¸ï¼š</strong> <span id="res_sc_count">0</span> å¼µ <br>
                    <strong>å”®å‡ºé‡‘é¡ï¼š</strong> $<span id="res_sc_money">0</span>
                    <input type="hidden" name="scratchSales" id="hidden_sc_sales">
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// åœ¨åŸæœ¬çš„å¯¦æ™‚è¨ˆç®—ç›£è½ä¸­åŠ å…¥æ­¤é‚è¼¯
document.querySelectorAll('.sc-logic').forEach(el => {
    el.addEventListener('input', calculateScratchInventory);
});

function calculateScratchInventory() {
    const prevB = Number(document.getElementById('sc_prev_book').value) || 0;
    const newB = Number(document.getElementById('sc_new_book').value) || 0;
    const prevL = Number(document.getElementById('sc_prev_loose').value) || 0;
    const todayB = Number(document.getElementById('sc_today_book').value) || 0;
    const todayL = Number(document.getElementById('sc_today_loose').value) || 0;
    
    // 19å¼µ/æœ¬ çš„é‚è¼¯
    const booksSold = (prevB + newB - todayB);
    const looseSold = (prevL - todayL);
    const totalSold = (booksSold * 19) + looseSold;
    const totalMoney = totalSold * 2000;

    document.getElementById('res_sc_count').innerText = totalSold;
    document.getElementById('res_sc_money').innerText = totalMoney.toLocaleString();
    document.getElementById('hidden_sc_sales').value = totalMoney;
    
    // è§¸ç™¼ç¸½çµç®—æ›´æ–°
    runGlobalCalculation(); 
}
</script>

