function doPost(e) {
  try {
    var ss = SpreadsheetApp.openById("1USVEYZabE5ET0qG2-D9AQrGh4nB2IX-jiidg0spKk14");
    var sheet = ss.getSheetByName("Data");
    var d = JSON.parse(e.postData.contents);
    
    // 嚴格對照 35 個名目順序
    var rowData = [
      new Date(),                 // A 時間
      d.date,                     // B 日期
      d.shift,                    // C 班別
      d.staff,                    // D 人員
      d.lottoSales,               // E 台彩銷售
      d.lottoVoid,                // F 台彩作廢
      d.lottoPayoutIn,            // G 台彩店內兌獎
      d.lottoPayoutOut,           // H 台彩跨店兌獎
      d.scratchLoad,              // I 刮刮樂拆封 (今日新進總面額)
      d.scratchSales,             // J 刮刮樂銷售 (由進銷存模組算出)
      d.scratchPayout,            // K 刮刮樂兌獎
      d.sportSales,               // L 運彩銷售
      d.sportVoid,                // M 運彩作廢
      d.sportPayout,              // N 運彩兌獎
      d.sportVirtual,             // O 運彩虛擬業績
      d.memberIn,                 // P 運彩會員儲值
      d.memberOut,                // Q 運彩會員出金
      d.c2000 || 0, d.c1000 || 0, d.c500 || 0, d.c200 || 0, d.c100 || 0, // R,S,T,U,V 鈔票
      d.m50 || 0, d.m10 || 0, d.m5 || 0, d.m1 || 0,                     // W,X,Y,Z 硬幣
      d.opening || 0,             // AA 期初週轉金
      d.bankAction || 0,          // AB 銀行存入
      0,                          // AC 店長提領 (預留)
      d.expNote || "",            // AD 雜支項目
      d.expAmount || 0,           // AE 雜支金額
      d.expectedCash,             // AF 應有現金
      d.actualCash,               // AG 實際現金
      d.diff,                     // AH 損益差異
      d.memo || ""                // AI 備註
    ];
    
    sheet.appendRow(rowData);
    return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
  } catch(err) {
    return ContentService.createTextOutput("Error: " + err.toString()).setMimeType(ContentService.MimeType.TEXT);
  }
}

